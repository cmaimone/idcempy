
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Tutorial for Estimating ZiOP Model &#8212; IDCeMPy  documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">IDCeMPy  documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tutorial-for-estimating-ziop-model">
<h1>Tutorial for Estimating ZiOP Model<a class="headerlink" href="#tutorial-for-estimating-ziop-model" title="Permalink to this headline">¶</a></h1>
<p>The zmiopc package contains functions to estimate “zero-inflated” ordered probit (ZiOP) models (ziop).</p>
<p>To illustrate its functionality, we use a dataset extracted from Besley and Persson (   <a class="reference external" href="https://www.aeaweb.org/articles?id=10.1257/aer.99.2.292">2009</a>). They use an Ordered Logit model to analyze the relationship between a number of economic and political covariates and the level of political violence. The outcome variable in our example is <em>‘rep_civwar_DV’</em>. It measures the level of <em>Political Violence</em>, which is coded as follows:</p>
<ul class="simple">
<li><p>0: Peace</p></li>
<li><p>1: Repression</p></li>
<li><p>2: Civil War</p></li>
</ul>
<img alt="_images/DV_Figure.png" src="_images/DV_Figure.png" />
<p>The plot above shows the number of obervations (country-year) for each potential outcome of the outcome variable. We can first see that there is an excessive number of “0”- zero observations. But it is possible that two different types of zero observations account for the “zero-inflation” in the data (see Bagozzi et al. <a class="reference external" href="https://journals.sagepub.com/doi/abs/10.1177/0022002713520530">2009</a> for further detail). The first type of zeroes may exist when countries do not experience any domestic conflict. The second type inlcudes those cases when dissidents are deterred, but violence is still a possibility.</p>
<p>Because of the two types of zero observations, the ZiOP model is more appropriate than the conventional ordered logit or ordered probit models.</p>
<p>Variables in the Outcome (Ordered Probit) equation:</p>
<ul class="simple">
<li><p><em>‘logGDPpc’</em>: (logged) GDP Per Capita</p></li>
<li><p><em>‘parliament’</em>: Whether the legislature is a parliamentary system</p></li>
<li><p><em>‘disaster’</em>: Weather shocks, the number of floods and heat waves (Emergency Disasters Database).</p></li>
<li><p><em>‘major_oil’</em>: Oil exporter, 1 for country-years in which more than 10 percent of a country’s gross domestic product (GDP) was generated by oil exports, 0 otherwise.</p></li>
<li><p><em>‘major_primary’</em>: Primary product exporter, 1 for country-years in which more than 10 percent of a country’s GDP was generated by primary product exports, 0 otherwise.</p></li>
</ul>
<p>Variables in the Inflation (Split-probit) equation:</p>
<ul class="simple">
<li><p><em>‘logGDPpc’</em>: (logged) GDP Per Capita.</p></li>
<li><p><em>‘parliament’</em>: Whether the legislature is a parliamentary system.</p></li>
</ul>
<p>The following code shows how to estimate the ZiOP model in Python:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">urllib</span>
<span class="c1">#Import pandas and urllib to read data from url</span>
<span class="kn">from</span>  <span class="nn">import</span> <span class="n">zmiopc</span>
<span class="c1">#Import data</span>
<span class="n">url</span><span class="o">=</span><span class="s1">&#39;https://github.com/hknd23/zmiopc/raw/master/data/bp_exact_for_analysis.dta&#39;</span>
<span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="c1"># Specify list of variable names (strings) X,Y,Z:</span>
<span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;logGDPpc&#39;</span><span class="p">,</span> <span class="s1">&#39;parliament&#39;</span><span class="p">,</span> <span class="s1">&#39;disaster&#39;</span><span class="p">,</span> <span class="s1">&#39;major_oil&#39;</span><span class="p">,</span> <span class="s1">&#39;major_primary&#39;</span><span class="p">]</span>
<span class="n">Z</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;logGDPpc&#39;</span><span class="p">,</span> <span class="s1">&#39;parliament&#39;</span><span class="p">]</span>
<span class="n">Y</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rep_civwar_DV&#39;</span><span class="p">]</span>

<span class="c1"># Starting parameters for optimization:</span>
<span class="n">pstartziop</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.31</span><span class="p">,</span> <span class="o">.</span><span class="mi">32</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="o">-.</span><span class="mi">21</span><span class="p">,</span><span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span><span class="o">.</span><span class="mi">9</span><span class="p">,</span><span class="o">-.</span><span class="mi">4</span><span class="p">])</span>

<span class="c1"># Model estimation:</span>
<span class="n">ziop_JCR</span><span class="o">=</span> <span class="n">zmiopc</span><span class="o">.</span><span class="n">ziopmod</span><span class="p">(</span><span class="n">pstartziop</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;bfgs&#39;</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">offsetx</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">offsetz</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># See estimates:</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ziop_JCR</span><span class="o">.</span><span class="n">coefs</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">zmiopc.ZiopModel</span></code> stores results from model estimation and other information.</p>
<p>Results from the model:</p>
<p>The following message will appear when the model finishes converging</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Warning: Desired error not necessarily achieved due to precision loss.
     Current function value: 1385.909054
     Iterations: 34
     Function evaluations: 529
     Gradient evaluations: 44
</pre></div>
</div>
<p>Use print(ziop_JCR.coefs) to see model results:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>                    Coef        SE         2.5%      97.5%
cut1              0.771855  0.352637     0.080686   1.463024
cut2             -0.098204  0.046598    -0.189536  -0.006872
Z int            18.781755  0.289231    18.214862  19.348647
Z logGDPpc       -2.081926  0.025977    -2.132841  -2.031010
Z parliament     -0.292586  0.251139    -0.784819   0.199647
X logGDPpc        0.041251  0.048662    -0.054127   0.136629
X parliament     -0.095081  0.133979    -0.357679   0.167517
X disaster        0.264986  0.034355     0.197651   0.332321
X major_oil       1.706935  0.299351     1.120208   2.293663
X major_primary  -0.422205  0.263260    -0.938194   0.093785
</pre></div>
</div>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">zmiopc.ZiopModel</span></code> also stores information such as log-likelihood, AIC, and Variance-Covariance matrix</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ziop_JCR</span><span class="o">.</span><span class="n">llik</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ziop_JCR</span><span class="o">.</span><span class="n">AIC</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ziop_JCR</span><span class="o">.</span><span class="n">vcov</span><span class="p">)</span>
</pre></div>
</div>
<p>To extract predicted probabilities from the model:
<code class="xref py py-func docutils literal notranslate"><span class="pre">zmiopc.ziopfit()</span></code> returns <a class="reference internal" href="api.html#zmiopc.FittedVals" title="zmiopc.FittedVals"><code class="xref py py-class docutils literal notranslate"><span class="pre">zmiopc.FittedVals</span></code></a> containing fitted probablities.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">fitttedziop</span> <span class="o">=</span> <span class="n">ziopc</span><span class="o">.</span><span class="n">ziopfit</span><span class="p">(</span><span class="n">ziop_JCR</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fitttedziopc</span><span class="o">.</span><span class="n">responsefull</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>array([[0.96910461, 0.02038406, 0.01051134],
     [0.95572439, 0.01995972, 0.02431589],
     [0.97773287, 0.01467479, 0.00759234],
     ...,
     [0.97039298, 0.02020078, 0.00940624],
     [0.97957951, 0.0150263 , 0.00539419],
     [0.98114903, 0.01386849, 0.00498248]])
</pre></div>
</div>
<p>The Vuong Test with a v statistic can be performed to compare the performance of the ZiOP model versus the standard Ordered Probit (OP) model using <code class="xref py py-func docutils literal notranslate"><span class="pre">zmiopc.vuong_opziop()</span></code>.
The OP and ZiOP must have the same number of observations, and the OP must have the same number of covariates as ZiOP’s OP stage. (see <a class="reference internal" href="op_tutorial.html"><span class="doc">Tutorial for Estimating OP Model</span></a> for details on fitting the OP model)</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">zmiopc</span><span class="o">.</span><span class="n">vuong_opziop</span><span class="p">(</span><span class="n">JCR_OP</span><span class="p">,</span> <span class="n">ziop_JCR</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>-4.909399264831751
</pre></div>
</div>
<p>A v statistic where v &lt; -1.96 favors the ZiOP model, -1.96 &lt; v &lt; 1.96 favors neither model, and v &gt; 1.96 favors the OP model.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/ziop_tutorial.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">IDCeMPy  documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Nguyen Huynh.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.0.
    </div>
  </body>
</html>